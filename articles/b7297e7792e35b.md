---
title: "ã€Flutterã€‘flavorã‚ã‘"
emoji: "ğŸ‘"
type: "tech"
topics: []
published: false
---

ä»¥ä¸‹ã®é–‹ç™ºç’°å¢ƒã€æœ¬ç•ªç’°å¢ƒã‚’ãã‚Œãã‚Œå®šç¾©ã™ã‚‹
| ç¨®é¡     | ãƒ“ãƒ«ãƒ‰ãƒ¢ãƒ¼ãƒ‰ | Flavor      | Configuration å   |
| -------- | ------------ | ----------- | ------------------ |
| é–‹ç™º     | Debug        | Development | Debug-Development  |
| ãƒªãƒªãƒ¼ã‚¹ | Release      | Production  | Release-Production |


# iOS
1.Schemeã®è¿½åŠ 
Xcode Menu > Product > Scheme > Manage Schemesã€€ã‹ã‚‰ã€Œï¼‹ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ä»¥ä¸‹ã®Target,Nameã‚’ãã‚Œãã‚Œè¿½åŠ ã™ã‚‹
| Target | Name | 
| -------- | ------------ | 
| Runner | Development | 
| Runner | Production  | 

![](https://storage.googleapis.com/zenn-user-upload/3a6945ce4475-20221016.png)

2.Configuration ã®è¿½åŠ 
ä»¥ä¸‹ã‚’æ–°ãŸã«å®šç¾©ã™ã‚‹
- Debug-Development
- Release-Production

1.Runner > PROJECT > Runner ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸç”»é¢ã® Configurations ã®ä¸‹éƒ¨ã®ã€Œ+ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã€Debug-Development ã¯æ—¢å­˜ã® Debug ã‹ã‚‰ã€ Release-Production ã¯æ—¢å­˜ã® Release ã‹ã‚‰è¤‡è£½ã—ã¦è¨­å®šã€‚
![](https://storage.googleapis.com/zenn-user-upload/0982327121bf-20221016.png)

2.
ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¨­å®šã™ã‚‹
- Development.xcconfig
- Production.xcconfig
- Debug-Development.xcconfig
- Release-Production.xcconfig

æ‰‹é †

æ¬¡ã«å·¦ãƒšã‚¤ãƒ³ã§å³ã‚¯ãƒªãƒƒã‚¯ã—New File...ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã€‚`Configuration Setting File`ã‚’é¸æŠã—ã€NEXTã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã€‚
![](https://storage.googleapis.com/zenn-user-upload/4882a066b5eb-20221016.png)

ä¿å­˜å ´æ‰€ï¼šios/Flutterã€Groupï¼šFlutterã€Targetï¼šRunnerã«ãƒã‚§ãƒƒã‚¯
![](https://storage.googleapis.com/zenn-user-upload/7c2fc5f9c8e6-20221016.png)

å„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã™ã‚‹
Development.xcconfig
```
FLUTTER_FLAVOR=Development
PRODUCT_BUNDLE_IDENTIFIER=<ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å>.dev
DISPLAY_NAME=<é–‹ç™ºç’°å¢ƒã®ã‚¢ãƒ—ãƒªå>
FLUTTER_TARGET=lib/main.dart
```

Production.xcconfig
```
FLUTTER_FLAVOR=Production
PRODUCT_BUNDLE_IDENTIFIER=<ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å>
DISPLAY_NAME=<ã‚¢ãƒ—ãƒªå>
FLUTTER_TARGET=lib/main.dart
```

Release-Production.xcconfig
```
#include "Release.xcconfig"
#include "Production.xcconfig"
```

Debug-Development.xcconfig
```
#include "Debug.xcconfig"
#include "Development.xcconfig"
```

Runner > PROJECT > Runner > Configurations ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«è¨­å®šã€‚
![](https://storage.googleapis.com/zenn-user-upload/06b233c973c5-20221016.png)

Xcode ã§ Runner > PROJECT > Runner > Build Settings (All, Combined ã‚’é¸æŠ) > Packaging > Product Bundle Identifier ã®å€¤ã‚’ã€ãã‚Œãã‚Œè¨­å®š
- Debug: <ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å>.dev
- Debug-Development: <ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å>.dev
- Release: <ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å>
- Release-Production: <ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å>

![](https://storage.googleapis.com/zenn-user-upload/4c8625359450-20221016.png)

Runner > TARGET > Runner ã‚‚åŒæ§˜ã«è¨­å®šã—ã¦ãŠã

ãƒ¡ãƒ¢ï¼šä»Šã“ã“ã¾ã§
flutter run --debug --flavor development


3.
Runner > Runner > info.plist ã«ä»¥ä¸‹ã‚’è¨­å®š
```
<key>FlutterFlavor</key>
<string>$(FLUTTER_FLAVOR)</string>
<key>CFBundleDisplayName</key>
<string>$(DISPLAY_NAME)</string>
```

Bundle name ã¯ãƒªãƒªãƒ¼ã‚¹ç‰ˆã®ã‚¢ãƒ—ãƒªåã‚’è¨­å®š
```
<key>CFBundleName</key>
<string>ã‚¢ãƒ—ãƒªå</string>
```

4.launch.jsonã®è¨­å®š
TODOï¼šlaunch.jsonã®è¨­å®šãŒã„ã‚‹ï¼Ÿ

FIXMEï¼šä»¥ä¸‹ã¨åŒã˜ï¼Ÿã“ã®æ‰‹é †ã¯6ã§è¡Œã†ï¼Ÿ
Android Studio ã§é–‹ç™ºã—ãªãŒã‚‰ã€ãã‚Œãã‚Œã®ãƒ“ãƒ«ãƒ‰ãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ã¯ã€ç”»é¢ä¸Šéƒ¨ã€Simulator ã®é¸æŠãƒœãƒƒã‚¯ã‚¹å³éš£ã® Edit Configurations ã‚’è¿½åŠ ã—ã¾ã™ã€‚

edit-configuration-1

ãã‚Œãã‚Œ

Name: Debug-Development
Name: Release-Staging
Name: Release-Production
ã«å¯¾ã—ã¦ã€

Additional Arguments ã¨ã—ã¦ã€

--debug --flavor development --dart-define=FLAVOR=development
--release --flavor staging --dart-define=FLAVOR=staging
--release --flavor production --dart-define=FLAVOR=production
Build Flavor ã¨ã—ã¦ã€

development
staging
production

5.Firebaseã®è¨­å®š
Runner>Runnerã§å³ã‚¯ãƒªãƒƒã‚¯ã—ã€New Groupã‚’ã‚¯ãƒªãƒƒã‚¯ã€€åå‰ã‚’`Firebase`ã¨ã—ã¦ã€ãã‚Œãã‚Œã®ç’°å¢ƒã‹ã‚‰å¾—ã‚‰ã‚Œã‚‹`GoogleService-Info.plist`ã‚’ãƒªãƒãƒ¼ãƒ ã—ã¦æ ¼ç´ã™ã‚‹
- é–‹ç™ºç’°å¢ƒï¼šGoogleService-Info-Development.plist
- æœ¬ç•ªç’°å¢ƒï¼šGoogleService-Info-Production.plist
![](https://storage.googleapis.com/zenn-user-upload/f296710b7a3c-20221016.png)

Runner > Targets > Runner > Build Phases ã‚’é–‹ãNew Run Script Phaseã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹
ä½œæˆã•ã‚ŒãŸRun Scriptã‚’ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã—ã€é©å½“ãªåå‰ã«å¤‰æ›´ã—ã¦ãŠãï¼ˆä¾‹ãˆã°Change Google Service Infoï¼‰
![](https://storage.googleapis.com/zenn-user-upload/d261a038dd0a-20221016.png)
â€»é †åºã‚’Copy Bundle Resourcesã®ä¸Šã«æŒã£ã¦ã„ã

ä»¥ä¸‹ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ã‚¹ã‚¯ãƒªãƒ—ãƒˆæ¬„ã«è²¼ã‚Šä»˜ã‘ã‚‹
```
if [[ "${CONFIGURATION}" == "Debug-Development" ]]; then
    rm $PRODUCT_NAME/GoogleService-Info.plist
    cp $PRODUCT_NAME/Firebase/GoogleService-Info-Development.plist $PRODUCT_NAME/GoogleService-Info.plist
    echo "GoogleService-Info-Development.plist copied."
elif [[ "${CONFIGURATION}" == "Release-Production" ]]; then
    rm $PRODUCT_NAME/GoogleService-Info.plist
    cp $PRODUCT_NAME/Firebase/GoogleService-Info-Production.plist $PRODUCT_NAME/GoogleService-Info.plist
    echo "GoogleService-Info-Production.plist copied."
elif [[ "${CONFIGURATION}" == "Release" ]]; then
    rm $PRODUCT_NAME/GoogleService-Info.plist
    cp $PRODUCT_NAME/Firebase/GoogleService-Info-Production.plist $PRODUCT_NAME/GoogleService-Info.plist
    echo "GoogleService-Info-Production.plist copied."
else
    echo "configuration didn't match to Development, Staging or Production"
    echo $CONFIGURATION
    exit 1
fi
```

ã¾ãŸã€Output Fileã«`$SRCROOT/Runner/GoogleService-Info.plist`è¿½åŠ ã—ã¦ãŠãã€‚
![](https://storage.googleapis.com/zenn-user-upload/19fb3bc600be-20221016.png)


6.å¤‰æ•°ã®è¨­å®š

Xcode å´ã§ã‚‚åŒæ§˜ã«ã€Edit Schemes ã‹ã‚‰ã€ãã‚Œãã‚Œã®ãƒ“ãƒ«ãƒ‰ãƒ¢ãƒ¼ãƒ‰ã«åˆã‚ã›ãŸç’°å¢ƒå¤‰æ•°ã‚’è¨­å®š
![](https://storage.googleapis.com/zenn-user-upload/65a36d9a276f-20221016.png)

Info > Build Configuration: Debug-Development, Release-Production ã®ã†ã¡ã®é©åˆ‡ãªã‚‚ã®
![](https://storage.googleapis.com/zenn-user-upload/d21816a3c71d-20221016.png)

Arguments > Environment Variables: FLAVOR ã¨ã„ã†ç’°å¢ƒå¤‰æ•°ã«å¯¾ã—ã¦ development, production ã®ã†ã¡ã®é©åˆ‡ãªã‚‚ã®
![](https://storage.googleapis.com/zenn-user-upload/1886291972de-20221016.png)

7.ã‚¨ãƒ©ãƒ¼å¯¾å¿œ
Podfileã«ä»¥ä¸‹ã‚’è¿½åŠ ã™ã‚‹
![](https://storage.googleapis.com/zenn-user-upload/e812037116d0-20221017.png)


# Android
1.ä»¥ä¸‹ã®ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆã—ã¦ã€ãã®ä¸­ã«ãã‚Œãã‚Œã®ç’°å¢ƒã®`google-services.json`ã‚’é…ç½®
- android/app/src/development
- android/app/src/production
![](https://storage.googleapis.com/zenn-user-upload/48085fd61f3c-20221017.png)

2.ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã€jks ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã™ã‚‹
- jksãƒ•ã‚¡ã‚¤ãƒ«ã®åå‰ï¼š`debug.jks`, `release.jks`
- ã‚¨ã‚¤ãƒªã‚¢ã‚¹åï¼š`debug_key`, `release_key`
FIXME:debugã¯ä½œæˆã™ã‚‹å¿…è¦ãªã„ï¼Ÿ
```
keytool -genkey -v -keystore {jks ã®ãƒ•ã‚¡ã‚¤ãƒ«å} -alias {ã‚¨ã‚¤ãƒªã‚¢ã‚¹å} -keyalg RSA -keysize 2048 -validity 10000
```

3.release_keyã‚’é…ç½®ã™ã‚‹ï¼Ÿ

4.android/app/build.gradleã‚’ç·¨é›†ã™ã‚‹
![](https://storage.googleapis.com/zenn-user-upload/cbb3ead31440-20221018.png)

5.android/app/src/main/AndroidManifest.xmlã‚’ç·¨é›†ã™ã‚‹
```
<application
        android:label="@string/app_name"
        android:name="${applicationName}"
        android:icon="@mipmap/ic_launcher">
        <activity
```

6.Android Studioã®è¨­å®š
TODO:
--debug --flavor development --dart-define=FLAVOR=development
--release --flavor production --dart-define=FLAVOR=production